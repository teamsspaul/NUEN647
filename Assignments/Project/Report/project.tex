
\documentclass[11pt,notitlepage]{article}

\usepackage{amsfonts, amsmath, amsthm, amssymb} % For math fonts
\usepackage{booktabs} % Top and bottom rules for table
\usepackage{wrapfig} % Allows in-line images
\usepackage[labelfont=bf]{caption} % Make figure numbering in captions bold
\usepackage{graphicx} % Required for including images
\usepackage[top=0.7in,bottom=1in,left=1in,right=1in]{geometry}
%\pagestyle{empty} % Remove page numbering
\newcommand{\tss}{\textsuperscript}
\newcommand{\tsbs}{\textsubscript}
\usepackage{float}
\hyphenation{ionto-pho-re-tic iso-tro-pic fortran} % Specifies custom hyphenation points for words or words that shouldn't be hyphenated at all
\newcommand\tab[1][0.6cm]{\hspace*{#1}}


\usepackage[usenames,dvipsnames]{color} % Required for custom colors
\usepackage{listings} % Required for insertion of code
\usepackage{courier} % Required for the courier font
\usepackage{mathtools}

%--------------------------------------------------------------------------
%	CODE INCLUSION CONFIGURATION
%--------------------------------------------------------------------------
% This is the color used for comments
\definecolor{MyDarkGreen}{rgb}{0.0,0.4,0.0} 
\lstloadlanguages{Perl,Python} % Load Perl syntax for listings,
% for a list of other languages supported see:
%ftp://ftp.tex.ac.uk/tex-archive/macros/latex/contrib/listings/listings.pdf
\lstset{language=Perl, % Use Perl in this example
        frame=single, % Single frame around code
        basicstyle=\small\ttfamily, % Use small true type font
        %keywordstyle=[1]\color{Blue}\bf, % Perl functions bold and blue
        %keywordstyle=[2]\color{Purple}, % Perl function arguments purple
        % Custom functions underlined and blue
        %keywordstyle=[3]\color{Blue}\underbar, 
        identifierstyle=, % Nothing special about identifiers
        % Comments small dark green courier font
        %commentstyle=\usefont{T1}{pcr}{m}{sl}\color{MyDarkGreen}\small, 
        %stringstyle=\color{Purple}, % Strings are purple
        showstringspaces=false, % Don't put marks in string spaces
        tabsize=5, % 5 spaces per tab
        %
        % Put standard Perl functions not included
        % in the default language here
        morekeywords={rand},
        %
        % Put Perl function parameters here
        morekeywords=[2]{on, off, interp},
        %
        % Put user defined functions here
        morekeywords=[3]{test},
       	%
        % Line continuation (...) like blue comment
        %morecomment=[l][\color{Blue}]{...}, 
        numbers=left, % Line numbers on left
        firstnumber=1, % Line numbers start with line 1
        %numberstyle=\tiny\color{Blue}, % Line numbers are blue and small
        numberstyle=\tiny
        stepnumber=5 % Line numbers go in steps of 5
}


\lstset{language=Python, % Use Python in this example
        frame=single, % Single frame around code
        basicstyle=\small\ttfamily, % Use small true type font
        keywordstyle=[1]\color{Blue}\bf, % Python functions bold and blue
        keywordstyle=[2]\color{Purple}, % Python function arguments purple
        % Custom functions underlined and blue
        keywordstyle=[3]\color{Blue}\underbar, 
        identifierstyle=, % Nothing special about identifiers
        % Comments small dark green courier font
        commentstyle=\usefont{T1}{pcr}{m}{sl}\color{MyDarkGreen}\small, 
        stringstyle=\color{Purple}, % Strings are purple
        showstringspaces=false, % Don't put marks in string spaces
        tabsize=3, % 5 spaces per tab
        %
        % Put standard Python functions not included in the
        % default language here
        morekeywords={rand},
        %
        % Put Python function parameters here
        morekeywords=[2]{on, off, interp},
        %
        % Put user defined functions here
        morekeywords=[3]{test},
       	%
        % Line continuation (...) like blue comment
        morecomment=[l][\color{Blue}]{...}, 
        numbers=left, % Line numbers on left
        firstnumber=1, % Line numbers start with line 1
        numberstyle=\tiny\color{Blue}, % Line numbers are blue and small
        stepnumber=5 % Line numbers go in steps of 5
}


% Creates a new command to include a perl script, the first
% parameter is the filename of the script (without .inp), the
% second parameter is the caption
\newcommand{\inputdeck}[2]{
\begin{itemize}
\item[]\lstinputlisting[caption=#2,label=#1,language=Perl]{#1.inp}
\end{itemize}
}

\newcommand{\inputdeckpages}[4]{
\begin{itemize}
\item[]\lstinputlisting[caption=#2,label=#1,language=Perl,
       firstline=#3,lastline=#4,basicstyle=\scriptsize]{#1.inp}
\end{itemize}
}

%\lstinputlisting[language=Octave, firstline=2, lastline=12]{BitXorMatrix.m}

\newcommand{\pythonscript}[2]{
\begin{itemize}
\item[]\lstinputlisting[caption=#2,label=#1]{#1}
\end{itemize}
}


\usepackage{enumitem,amssymb}
\newlist{todolist}{itemize}{2}
\setlist[todolist]{label=$\square$}
\usepackage{pifont}
\newcommand{\cmark}{\ding{51}}%
\newcommand{\xmark}{\ding{55}}%
\newcommand{\done}{\rlap{$\square$}{\raisebox{2pt}{\large\hspace{1pt}\cmark}}%
  \hspace{-2.5pt}}
\newcommand{\wontfix}{\rlap{$\square$}{\large\hspace{1pt}\xmark}}



\renewcommand{\thesection}{\Roman{section}}

\begin{document}

\vspace*{0.5cm}

\noindent{\fontsize{16}{19.2}\selectfont
  \textbf{NUEN 647 Final Project}}

\vspace{1cm}
Uncertainty quantification of depletion calculations
for specific isotopes using ORIGEN2.

%------------------------------------------------------------
%	Introduction
%------------------------------------------------------------
 
\section{Introduction}

\tab
Determing composition of irradiated fuel is of importance
for a myriad of reasons. Whether for flux calculations,
reprocessing, or irradiation history verification,
calculating fuel composition requires a Bateman solver,
and a means for building a sparse matrix.

Applications using these compositions rarely report the
uncertainty associated with results, even when inputs,
such as flux shape, fission yield, cross sections,
and half-lives have varying degrees of uncertainty. Further
sources of error in this calculation are due to the multi-group
approximation, and single point approximation,
but will not be explored here.

Several isotope concentrations, shown in Table \ref{Table:1},
were calculated as a function of burnup
with the depletion code ORIGEN2 for a PWR system with 3 Wt\%
enriched uranium. ORIGEN2 solves the bateman equations with
the matrix expoential method and requires a library
with decay and cross section information. Cross sections and
fission product yields are reduced to single group through flux
averaging before execution of the code,
with the assumption that the flux has the same shape as a typical PWR.

The uncertainty of concentrations were determined by varying the
cross section, fission yeild, and half-life information
that was fed into ORIGEN2. The uncertainties on cross sections
were determined by calculating the range of the single group
cross section, taking the mid point as a mean, the range as
a standard deviation, and assuming a Gaussian distribution.
A similar calculation was done for the fisison yields, and
half-life distributions were taken at face value as normally
distributed. 

\begin{table}[H]
  \begin{center}
    \caption{Isotope solve list.}
    \label{Table:1}
    \begin{tabular}{l l l}
      \toprule
      \tss{133}Cs & \tss{136}Ba & \tss{153}Eu\\
      \tss{134}Cs & \tss{138}Ba & \tss{154}Eu\\
      \tss{135}Cs & \tss{149}Sm & \tss{239}Pu\\
      \tss{137}Cs & \tss{150}Sm & \tss{242}Pu\\
      \tss{148}Nd & \tss{106}Rh & \tss{125}Sb\\
      \bottomrule
    \end{tabular}
  \end{center}
\end{table}

%------------------------------------------------------------
%	Objectives
%------------------------------------------------------------

\section{Objectives}

\begin{todolist}
\item[\done]{Build ORIGEN2 model for thermal system which
  calculates concentrations of isotopes shown in
  Table \ref{Table:1}.}

  \inputdeck{../Origen2/TAPE5}{PWR Input Deck}

  The model irradiates 1 metric ton of US PWR fuel for a single
  cycle (15,000 MWd/Mt). The calculations use a constant power assumption
  of 37.5 W/g. The model does not include the oxygen because
  we are not interested in the activation of oxygen.
  Cross section modifcation throughout the calculation
  use the changing flux associated with a US PWR. 

  Initial verification of the model analyzed the end concentration of
  \tss{137}Cs and calculated the burn-up from that value. This calculation
  does not have an exact value for the yield of \tss{137}Cs and is
  used qualitatively as a sanity check.

  \begin{equation*}
    \frac{552.8\ \text{g \tss{137}Cs}}{Mt}\cdot
    \frac{6.022E23\ \text{atoms}}{137\ \text{g \tss{137}Cs}}\cdot
    \frac{\text{Fission}}{0.06\ \text{atoms}}\cdot
    \frac{200\ \text{MeV}}{\text{Fission}}\cdot
    \frac{1.602E-19\ \text{MJ}}{1\ \text{MeV}}\cdot
    \frac{1\ \text{day}}{86400\ \text{s}}=15,018\ \frac{\text{MWd}}{Mt}
  \end{equation*}

\item[\done]{Determine how to vary cross section and or flux spectrum
  inputs for calculation}
\item[\done]{Determine how to vary fission yields for calculation}
\item[\done]{Determine how to vary half-life information for calculation}
  
  ORIGEN2 reads in cross section information through a file
  named ``TAPE9.inp'', specified by the 8th input on the LIB card.
  ``TAPE9.inp'' needs at least 3 cross section libraries. These
  are specified by the 5th 6th and 7th inputs on the LIB card as
  601, 602, and 603 for the activation products, actinides, and
  fission products, respectively. The input for \tss{137}Cs
  from library 603 is shown in the listing below, with
  a corresponding key shown in Table \ref{Table:2} \cite{croff1980user}.
  
  \inputdeckpages{../Origen2/TAPE9_BANK}{\tss{137}Cs cross section
  library 603 input}{5066}{5067}

  \begin{table}[H]
  \begin{center}
    \caption{Key to parameters in cross section library}
    \label{Table:2}
    \begin{tabular}{l l l l l l l l l}
      \toprule
      LIB & NUCLID & (n,$\gamma$) & (n,2n) & (n,$\alpha$) &
      (n,p) & (n,$\gamma^*$) & (n,2n\tss{*}) & YYN\\
      LIB & Y(\tss{232}Th) & Y(\tss{233}U) & Y(\tss{235}U) &
      Y(\tss{238}U) & Y(\tss{239}Pu) & Y(\tss{241}Pu) &
      Y(\tss{245}Cm) & Y(\tss{249}Cf)\\
      \bottomrule
    \end{tabular}
  \end{center}
  \end{table}

  Both $\sigma_\gamma$ and yield will be modified based on the
  locations in the cross section libraries shown above.
  Half-life information is contained in the decay
  libraries 1, 2, and 3 for activation products, actinides,
  and fission products, respectively. The input for \tss{137}Cs
  from library 3 is shown in the listing below, with
  a corresponding key shown in Table \ref{Table:3} \cite{croff1980user}.
  
  \inputdeckpages{../Origen2/TAPE9_BANK}{\tss{137}Cs cross section
  library 603 input}{2896}{2897}

  \begin{table}[H]
  \begin{center}
    \caption{Key to parameters in decay library}
    \label{Table:3}
    \begin{tabular}{l l l l l l l l l l}
      \toprule
      LIB & NUCLID & IU & THALF & FBX &
      FPEC & FPECX & FA & FIT & FSF\\
      LIB & - & - & FN & QREC &
      ABUND & ARCG & WRCG &
      -  & - \\
      \bottomrule
    \end{tabular}
  \end{center}
  \end{table}

  Also, a program was writen to modify $\sigma_\gamma$, yield,
  or half-life based on lines from a text file. This code is
  shown below.

  \pythonscript{../ChangeTAPE/change}{Script for modifying ORIGEN2 input.}

  
  
\item{Create a sampling space for all possible variations of
  calculations}

  I might have to reduce the number of elements to look at,
  maybe I'll start by
  just looking at \tss{154}Eu.
  \begin{equation*}
    ^{153}Pm\xrightarrow{\beta^-} {^{153}Sm}\xrightarrow{\beta^-}
    {^{153}Eu}
    \xrightarrow{(n,\gamma)} {^{154}Eu}
  \end{equation*}

  \begin{table}[H]
  \begin{center}
    \caption{Summary of parameters to vary for \tss{154}Eu}
    \label{Table:4}
    \begin{tabular}{l|l|l|l}
      \toprule
      Isotope & Half-life & $\sigma_\gamma$ & Yield\\
      \hline
      \tss{153}Pm & 5.25 $\pm$ 0.02 min & SIGMA & Yield \\
      \tss{153}Sm & 46.284 $\pm$ 0.004 hr & SIGMA & Yield\\
      \tss{153}Eu & Stable & SIGMA & Yield \\
      \tss{154}Eu & 8.60 $\pm$ 0.01 y  & SIGMA & Yield \\
      \bottomrule
    \end{tabular}
  \end{center}
  \end{table}

  In order to determine the sigma and yield variables I am planning on
  flux averaging both via:

  \begin{equation*}
    \sigma=\frac{\int\sigma(E)\phi(E)dE}{\int\phi(E)dE}
  \end{equation*}

  and
  
  \begin{equation*}
    \gamma=\frac{\int\gamma(E)\phi(E)dE}{\int\phi(E)dE}
  \end{equation*}

  where:

  \begin{align*}
    \phi(E) =& C_1\cdot E \cdot exp\left(-\frac{E}{0.025\
      \text{eV}}\right)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 
    \ \ \ \ \ \ \ \ E<0.625\ \text{eV}\\
    =& \frac{C_2}{E}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \
    \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \
    \ \ \ \ \ \ \ 0.625<E<1
    \ \text{MeV}\\
    =& C_3 \cdot \sqrt{E}\cdot exp\left(-\frac{E}{2E6}
    \right)
    \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ E>1\ \text{MeV}
  \end{align*}

  and:

  \begin{align*}
    C_1=&\frac{1}{E^2_{max,th}e^{-E_{max,th}/0.025}}=3.555313629e-11
      \\
      C_2=&1\\
      C_3=&\frac{1}{E^{3/2}_{max,epi}e^{-E_{max,epi}/2e6}}=1.64872e-09
  \end{align*}

  I was going to calculate $\sigma_\gamma$ with nominal cross section
  values, then with error subtracted, and then added. These values would
  constitue a mean with error. A similiar calculation would be done for
  the yields.
  
\item{Determine importance of various uncertain parameters
  by running the code a number of times randomly sampling
  the sample space (still not 100\% sure how to do this -
  not even 50\% sure how to do this)}
\end{todolist}


%------------------------------------------------------------
%	Quantities of Interest and uncertain parameters
%------------------------------------------------------------

\section{Quantities of Interest and Uncertain Parameters}

Quantities of interest are shown in Table \ref{Table:1} above.
Uncertain parameters are listed below:

\begin{itemize}
\item{Fission yield}
\item{Cross sections}
\item{Half-lives}
\end{itemize}

%------------------------------------------------------------
%	Prediction
%------------------------------------------------------------

\section{Prediction}

The first major prediction for this project is that half-lives
will not have a large impact on results because they are
relatively well known. Secondly, \tss{125}Sb is notorious
for being difficult to calculate correctly, I would would predict that
there would be large uncertainties due to uncertainties in
the cross section data.

%-----------------------------------------------------------
\bibliography{references}
\bibliographystyle{plain}


\end{document}
